# oAuth2

## 组件
* resource owner 使用浏览器的人
* protected resource 受到保护的web API
* client 资源拥有者使用的软件，可以访问受保护资源
* authorization server 授权服务器，被受保护资源信任，桥接client和protected resource

## 认证流程

![image](./img/oauth_process.png)

资源拥有者像客户端表示他希望客户端代表他执行一些任务（例如“从该服务下载我的照片”）

1. 客户端请求授权
2. 资源拥有者许可授权
3. 客户端发送授权许可
4. 授权服务器发送访问令牌
5. 客户端发送访问令牌
6. 受保护资源发送资源

## 授权许可完整流程

![image](./img/auth_grant_detail.png)

1. 客户端将用户代理重定向至授权端点
2. 用户代理加载授权端点
3. 资源拥有者向授权服务器进行身份认证
4. 资源拥有者向客户端授权
5. 授权服务器将用户代理重定向到客户端，携带授权码
6. 用户代理加载携带授权码的客户端重定向URI
7. 客户端发送验证码和自身凭据给验证服务器
8. 验证服务器发送令牌给客户端
9. 客户端发送令牌给受保护资源
10. 受保护资源给客户端返回资源